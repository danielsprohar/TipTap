<ng-container *ngIf="lesson$ | async as lesson; else loading">
  <section class="container">
    <table>
      <thead>
        <th>Time remaining</th>
        <th>Errors</th>
        <th>Total characters</th>
        <th>Words / Min</th>
      </thead>
      <tbody>
        <tr>
          <td *ngIf="inProgress && (timer$ | async) as timer; else default">
            {{ session.duration - timer }}
          </td>
          <ng-template #default>
            <td>{{ session.duration }}</td>
          </ng-template>
          <ng-container
            *ngIf="metrica$ | async as metrica; else defaultMetrica"
          >
            <td>{{ metrica.errorCount }}</td>
            <td>{{ metrica.characterCount }}</td>
            <td>{{ metrica.wpm }}</td>
          </ng-container>
          <ng-template #defaultMetrica>
            <td>0</td>
            <td>0</td>
            <td>0</td>
          </ng-template>
        </tr>
      </tbody>
    </table>
  </section>

  <app-terminal [lesson]="lesson"></app-terminal>
  <app-keyboard></app-keyboard>
  <app-results-dialog></app-results-dialog>
</ng-container>

<ng-template #loading>
  <div class="container">
    <article aria-busy="true"></article>
  </div>
</ng-template>
